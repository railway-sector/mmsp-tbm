"use strict";(self.webpackChunkmmsp_tbm=self.webpackChunkmmsp_tbm||[]).push([[62075],{62075:(t,e,i)=>{i.d(e,{AxisRendererXAm5:()=>g.j,AxisRendererYAm5:()=>m.Q,CategoryAxisAm5:()=>d,ColumnSeriesAm5:()=>I.k,LineSeriesAm5:()=>x.I,ValueAxisAm5:()=>n.F,XYChartAm5:()=>u.C,XYCursorAm5:()=>c.A});var s=i(39551),a=i(93218),n=i(62512),r=i(7552),o=i(55077),h=i(711),l=i(95788);class d extends s._{constructor(){super(...arguments),Object.defineProperty(this,"_frequency",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_itemMap",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._settings.themeTags=l.kE(this._settings.themeTags,["axis"]),this.fields.push("category","id","cellSize"),this.setPrivateRaw("name","category"),this.addTag("category"),super._afterNew()}_afterDataChange(){super._afterDataChange();const t=this.dataItems.length;t>0&&this.setPrivateRaw("maxZoomFactor",t),this.setPrivateRaw("startIndex",Math.min(this.getPrivate("startIndex",0),t)),this.setPrivateRaw("endIndex",Math.min(this.getPrivate("endIndex",t),1))}_prepareChildren(){super._prepareChildren();const t=this.dataItems.length;let e=0;this._valuesDirty&&(this._itemMap={},r.__(this.dataItems,t=>{t.setRaw("index",e),this._itemMap[t.get("category")]=t,e++}),this.setPrivateRaw("maxZoomFactor",t));let i=this.get("start",0),s=this.get("end",1),a=this._getIndices(i,s);this.setPrivateRaw("startIndex",a.startIndex),this.setPrivateRaw("endIndex",a.endIndex),(this._sizeDirty||this._valuesDirty||this.isDirty("start")||this.isDirty("end")||this.isPrivateDirty("endIndex")||this.isPrivateDirty("startIndex")||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&this.dataItems.length>0&&(this._handleRangeChange(),this._prepareAxisItems(),this._updateAxisRanges())}adjustZoom(){const t=this.dataItems.length;if(t>1){let e=this.get("maxZoomCount",this.dataItems.length),i=this.get("minZoomCount",1),s=0,a=this.getPrivate("startIndex",0),n=this.getPrivate("endIndex",0);const r=this._sAnimation,o=this._eAnimation;let h=this.get("start",0),l=!1;r&&!r.stopped&&(h=Number(r.to),l=!0);let d=this.get("end",1);if(o&&!o.stopped&&(d=Number(o.to),l=!0),l){const t=this._getIndices(h,d);a=t.startIndex,n=t.endIndex}for(let t=a;t<n;t++){s+=this.dataItems[t].get("finalCellSize",1)}if(s<=i){let e=0;for(let s=a;s<t;s++){if(e+=this.dataItems[s].get("finalCellSize",1),n=s+1,e>=i)break}if(e<i)for(let t=a-1;t>=0;t--){if(e+=this.dataItems[t].get("finalCellSize",1),a=t,e>=i)break}this.zoomToIndexes(a,n)}else if(s>=e){let t=s;for(let i=n-1;i>=a;i--){if(t-=this.dataItems[i].get("finalCellSize",1),t<=e){n=i+1;break}}this.zoomToIndexes(a,n)}}}_handleRangeChange(){r.__(this.series,t=>{let e=this.dataItems[this.startIndex()].get("category"),i=this.dataItems[this.endIndex()-1].get("category"),s=t.get("baseAxis"),a=t.get("xAxis"),o=t.get("yAxis");if(a instanceof d&&o instanceof d)t._markDirtyAxes();else if(s===this){let h,l,g=o;if(a===s?(t.get("categoryXField")&&(h="categoryX"),t.get("openCategoryXField")&&(l="openCategoryX")):o===s&&(t.get("categoryYField")&&(h="categoryY"),t.get("openCategoryYField")&&(l="openCategoryY"),g=a),g instanceof n.F&&(h||l)){let m,I;function x(t,e,i,s,a,n){let r,o=e.categoryToIndex(a);for(;!r&&o>=0&&o<e.dataItems.length;){let a=e.dataItems[o].get("category");if("previous"==n)for(let e=t.dataItems.length-1;e>=0;e--){let n=t.dataItems[e];if(i&&n.get(i)===a){r=n;break}if(s&&n.get(s)===a){r=n;break}}else for(let e=0,n=t.dataItems.length;e<n;e++){let n=t.dataItems[e];if(i&&n.get(i)===a){r=n;break}if(s&&n.get(s)===a){r=n;break}}r||(o+="previous"===n?-1:1)}return r}m=x(t,this,h,l,e,"next"),I=x(t,this,h,l,i,"previous");let u=0,c=t.dataItems.length;m&&(u=t.dataItems.indexOf(m)),I&&(c=t.dataItems.indexOf(I)+1),t.setPrivate("startIndex",u),t.setPrivate("endIndex",c);let f=!1;for(let _=u;_<c;_++){const p=t.dataItems[_];if(r.__(t.__valueXShowFields,t=>{null!=p.get(t)&&(f=!0)}),r.__(t.__valueYShowFields,t=>{null!=p.get(t)&&(f=!0)}),f)break}t.setPrivate("outOfSelection",!f)}t._markDirtyAxes()}})}_prepareAxisItems(){var t;const e=this.get("renderer"),i=this.dataItems.length;let s=this.startIndex();s>0&&s--;let a=this.endIndex();a<i&&a++;const n=e.get("minorLabelsEnabled"),r=e.get("minorGridEnabled",n);let o=e.axisLength()/Math.max(e.get("minGridDistance"),1),h=Math.max(1,Math.min(i,Math.ceil((a-s)/o)));s=Math.floor(s/h)*h,this._frequency=h;for(let d=0;d<i;d++)this._toggleDataItem(this.dataItems[d],!1);let l=this.dataItems[s].get("index",0);for(let d=s;d<a;d+=h){let t=this.dataItems[d];this._createAssets(t,[]),this._toggleDataItem(t,!0);let e=h;r&&(e=1),this._prepareDataItem(t,l,e),l++}if(e.get("minorGridEnabled"))for(let d=s;d<a;d++){let e=this.dataItems[d];d%h!=0&&(this._createAssets(e,["minor"],!0),this._toggleDataItem(e,!0),this._prepareDataItem(e,0,1),n||null===(t=e.get("label"))||void 0===t||t.setPrivate("visible",!1))}this._updateGhost()}_prepareDataItem(t,e,i){let s=this.get("renderer"),a=t.get("categoryLocation",0),n=t.get("endCategoryLocation",1),r=t.get("index");o.Et(r)||(r=this.categoryToIndex(t.get("category")));let h,l=this.indexToPosition(r,a),d=t.get("endCategory");d?(h=this.categoryToIndex(d),o.Et(h)||(h=r)):h=r;let g,m,I=this.indexToPosition(h,n);if(t.get("isRange")){if(g=h,!o.Et(r))return void this._toggleDataItem(t,!1)}else g=r+this._frequency-1;m=this.indexToPosition(g,n),s.updateLabel(t.get("label"),l,I,i),s.updateGrid(t.get("grid"),l,I),s.updateTick(t.get("tick"),l,I,i),s.updateFill(t.get("axisFill"),l,m),this._processBullet(t),s.updateBullet(t.get("bullet"),l,I);const x=this.get("fillRule");x&&x(t,e)}startIndex(){let t=this.dataItems.length;return Math.min(Math.max(this.getPrivate("startIndex",0),0),t-1)}endIndex(){let t=this.dataItems.length;return Math.max(1,Math.min(this.getPrivate("endIndex",t),t))}baseValue(){}basePosition(){return 0}getX(t){let e=this._itemMap[t];return e?this._settings.renderer.positionToCoordinate(this.indexToPosition(e.get("index",0))):NaN}getY(t){let e=this._itemMap[t];return e?this._settings.renderer.positionToCoordinate(this.indexToPosition(e.get("index",0))):NaN}getDataItemPositionX(t,e,i,s){const a=t.get(e),n=this._itemMap[a];return n?this.indexToPosition(n.get("index",0),i):NaN}getDataItemCoordinateX(t,e,i,s){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionX(t,e,i,s))}getDataItemPositionY(t,e,i,s){const a=t.get(e),n=this._itemMap[a];return n?this.indexToPosition(n.get("index",0),i):NaN}getDataItemCoordinateY(t,e,i,s){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionY(t,e,i,s))}indexToPosition(t,e,i){let s=this.dataItems.length,a=0;if(0==s)return 0;if(t>=s&&(t=s-1,e=1),o.Et(e)||(e=.5),!o.Et(t))return 0;let n=this.get("startLocation",0),h=this.get("endLocation",1);if(this.get("cellSizeField")){let s=i?"finalCellSize":"cellSize";const o=this.dataItems;let l=0;r.__(this.dataItems,t=>{l+=t.get(s,1)}),l-=n*o[0].get(s,1),l-=(1-h)*o[o.length-1].get(s,1);let d=0;for(let e=0;e<t;e++)d+=o[e].get(s,1);a=(d+e*o[t].get(s,1)-n*o[0].get(s,1))/l}else s-=n,s-=1-h,a=(t+e-n)/s;if(!i){let e=this.dataItems[t];e&&(a+=e.get("deltaPosition",0))}return a}categoryToPosition(t){let e=this._itemMap[t];return e?this.indexToPosition(e.get("index")):NaN}categoryToIndex(t){let e=this._itemMap[t];return e?e.get("index"):NaN}dataItemToPosition(t){return this.indexToPosition(t.get("index"))}roundAxisPosition(t,e){return t+=(.5-e)/this.dataItems.length,this.indexToPosition(this.axisPositionToIndex(t),e)}axisPositionToIndex(t){let e=this.dataItems.length;if(0===e)return 0;if(this.get("cellSizeField")){let i=0,s=[];r.__(this.dataItems,t=>{const e=t.get("cellSize",1);s.push(e),i+=e});let a=this.get("startLocation",0),n=this.get("endLocation",1);i-=a,i-=1-n;let o=t*i+a,h=0;for(let t=0;t<e;t++){const e=s[t];if(o<h+e)return t;h+=e}return e-1}return h.s_(Math.floor(t*e),0,e-1)}getTooltipText(t,e){const i=this.dataItems[this.axisPositionToIndex(t)];if(i){const t=i.get("label");if(t)return(0,a.I)(t,this.get("tooltipText",""))}}_updateTooltipText(t,e){t._setDataItem(this.dataItems[this.axisPositionToIndex(e)]),t.label.text.markDirtyText()}getSeriesItem(t,e){if(this.dataItems.length>0){let i=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),s=this.axisPositionToIndex(e),a=t.dataItems[s],n=this.dataItems[s],r=n.get("category");if(a&&n&&a.get(i)===r)return a;for(let e=0,o=t.dataItems.length;e<o;e++){let s=t.dataItems[e];if(s.get(i)===r)return s}}}_getIndices(t,e){let i=this.dataItems.length,s=0,a=i,n="cellSize";if(this.get("cellSizeField")){let o=0;const h=this.dataItems;if(0==h.length)return{startIndex:0,endIndex:0};r.__(h,t=>{o+=t.get(n,1)}),o-=this.get("startLocation",0)*h[0].get(n,1),o-=(1-this.get("endLocation",1))*h[h.length-1].get(n,1);let l=0;for(let e=0;e<i;e++)if(l+=this.dataItems[e].get(n,1),Math.round(l)>Math.round(t*o)){s=e;break}for(let t=s+1;t<i;t++)if(l+=this.dataItems[t].get(n,1),Math.round(l)>=Math.round(e*o)){a=t+1;break}s=Math.max(s,0),a=Math.min(a,i)}else s=Math.max(Math.round(this.get("start",0)*i),0),a=Math.min(Math.round(this.get("end",1)*i),i);return{startIndex:s,endIndex:a}}zoomToIndexes(t,e,i){let s=this.dataItems.length;this.get("cellSizeField")?(t=Math.min(Math.max(t,0),s),e=Math.max(Math.min(e,s),1),this.setPrivateRaw("startIndex",t),this.setPrivateRaw("endIndex",e),this.zoom(this.indexToPosition(t,0,!0),this.indexToPosition(e,0,!0),i)):this.zoom(t/s,e/s,i)}zoomToCategories(t,e,i){this.zoomToIndexes(this.categoryToIndex(t),this.categoryToIndex(e)+1,i)}getCellWidthPosition(){return this._frequency/this.dataItems.length/(this.get("end",1)-this.get("start",0))}nextPosition(t){null==t&&(t=1),"Y"==this.get("renderer").getPrivate("letter")&&(t*=-1);const e=this.getPrivate("tooltipPosition",0),i=h.s_(this.axisPositionToIndex(e)+t,0,this.dataItems.length-1);return this.toGlobalPosition(this.indexToPosition(i))}}Object.defineProperty(d,"className",{enumerable:!0,configurable:!0,writable:!0,value:"CategoryAxis"}),Object.defineProperty(d,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:s._.classNames.concat([d.className])});var g=i(85486),m=i(11501),I=i(69687),x=i(8075),u=i(6686),c=i(33227)}}]);
//# sourceMappingURL=62075.7dd92ac2.chunk.js.map